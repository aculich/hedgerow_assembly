rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
binary <- FALSE#
alpha <- TRUE#
## int or pols#
type <- "int"#
source('src/initialize_beta.R')
mod.pols <- lmer(dist ~ status +  (1|site),#
                 data=dats.pols)
load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
       paste(dis.method, alpha, occ, type, sep='_'))))
head(dats.pols)
rm(list=ls())#
library(RSQLite)#
setwd('~/Dropbox/pollinator_beta_study/data/relational/relational')#
#
source('../src/relational_prep.R')#
print(dim(specimens[!is.na(specimens$Abund),]))#
source('../src/relational_make.R')#
print(dim(specimens))#
source('../src/make_traditional.R')#
print(dim(res.complete))#
#
## 94#
dim(res.complete)-dim(specimens)
rm(list=ls())#
library(RSQLite)#
setwd('~/Dropbox/pollinator_beta_study/data/relational/relational')#
#
source('../src/relational_prep.R')#
print(dim(specimens[!is.na(specimens$Abund),]))#
source('../src/relational_make.R')#
print(dim(specimens))#
source('../src/make_traditional.R')#
print(dim(res.complete))#
#
## 94#
dim(res.complete)-dim(specimens)
rm(list=ls())#
setwd('~/Dropbox/pollinator_beta_study/data/relational/relational')#
#
source('../src/updated/src/relational_prep.R')#
print(dim(animal[!is.na(animal$abundance),]))#
#
source('../src/updated/src/relational_make.R')#
print(dim(specimens))#
#
source('../src/updated/src/traditional_make.R')#
print(dim(res.complete)[1])#
#
## the number of rows dropped#
dim.diff <- dim(res.complete)[1]-dim(specimens)[1]#
if(dim.diff !=0 ) print(paste(dim.diff, "rows were dropped"))
?comdist
library(ape)
?comdist
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
source('src/initialize.R')#
source('src/phyloIntBeta.R')#
source('src/plotDists.R')
?comdist
?comdist
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
source('src/initialize.R')
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
source('src/initialize.R')
head(specs)
spec$GenusSpecies
occ.k.cv <- cv.trait(spec,#
                     specs[specs$speciesType =="pollinator",],#
                     trait="occ.date",#
                     method= "time", time.col="assem",#
                     abund.col="k",#
                     cv.function=cv,#
                     zero2na=TRUE,#
                     standard.cv=TRUE,#
                     na.rm=TRUE)#
summary(occ.k.cv$lm.nss)
occ.closeness.cv <- cv.trait(spec,#
                             specs[specs$speciesType =="pollinator",],#
                             trait="occ.date",#
                             method= "time", time.col="assem",#
                             abund.col="weighted.closeness",#
                             cv.function=cv,#
                             zero2na=TRUE,#
                             standard.cv=TRUE,#
                             na.rm=TRUE)#
summary(occ.closeness.cv$lm.nss)
## sig#
degree.closeness.cv <- cv.trait(spec,#
                                specs[specs$speciesType =="pollinator",],#
                                trait="degree",#
                                method= "time", time.col="assem",#
                                abund.col="weighted.closeness",#
                                cv.function=cv,#
                                zero2na=TRUE,#
                                standard.cv=TRUE,#
                                na.rm=TRUE)#
summary(degree.closeness.cv$lm.nss)
occ.k.sd$data$degree <-#
  degree$data$traits.ns[match(occ.k.sd$data$GenusSpecies,#
                              degree$data$GenusSpecies)]
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
source('src/initialize.R')#
#
## ************************************************************#
## coefficient of variation of degree thingy through time#
## ************************************************************#
## ************************************************************#
## occurrence#
## ************************************************************#
## pollinators and k#
## sig!#
occ.k.cv <- cv.trait(spec,#
                     specs[specs$speciesType =="pollinator",],#
                     trait="occ.date",#
                     method= "time", time.col="assem",#
                     abund.col="k",#
                     cv.function=cv,#
                     zero2na=TRUE,#
                     standard.cv=TRUE,#
                     na.rm=TRUE)#
summary(occ.k.cv$lm.nss)#
#
## plants and k#
## not sig!#
plants.occ.k.cv <- cv.trait(spec,#
                            specs[specs$speciesType =="plant",],#
                            trait="occ.plant.date",#
                            method= "time", time.col="assem",#
                            abund.col="k",#
                            cv.function=cv,#
                            zero2na=TRUE,#
                            standard.cv=TRUE,#
                            na.rm=TRUE,#
                            species.type="PlantGenusSpecies")#
summary(plants.occ.k.cv$lm.nss)#
#
## pollinators and closeness#
## sig#
occ.closeness.cv <- cv.trait(spec,#
                             specs[specs$speciesType =="pollinator",],#
                             trait="occ.date",#
                             method= "time", time.col="assem",#
                             abund.col="weighted.closeness",#
                             cv.function=cv,#
                             zero2na=TRUE,#
                             standard.cv=TRUE,#
                             na.rm=TRUE)#
summary(occ.closeness.cv$lm.nss)#
#
## plants and closeness#
## not sig#
plants.occ.closeness.cv <- cv.trait(spec,#
                                    specs[specs$speciesType =="plant",],#
                                    trait="occ.plant.date",#
                                    method= "time", time.col="assem",#
                                    abund.col="weighted.closeness",#
                                    cv.function=cv,#
                                    zero2na=TRUE,#
                                    standard.cv=TRUE,#
                                    na.rm=TRUE,#
                                    species.type="PlantGenusSpecies")#
summary(plants.occ.closeness.cv$lm.nss)#
#
## ************************************************************#
## degree#
## ************************************************************#
## pollinators and k#
## sig#
degree.k.cv <- cv.trait(spec,#
                        specs[specs$speciesType =="pollinator",],#
                        trait="degree",#
                        method= "time", time.col="assem",#
                        abund.col="k",#
                        cv.function=cv,#
                        zero2na=TRUE,#
                        standard.cv=TRUE,#
                        na.rm=TRUE)#
summary(degree.k.cv$lm.nss)#
#
## plants and k#
## sig#
plants.degree.k.cv <- cv.trait(spec,#
                               specs[specs$speciesType =="plant",],#
                               trait="plant.degree",#
                               method= "time", time.col="assem",#
                               abund.col="k",#
                               cv.function=cv,#
                               zero2na=TRUE,#
                               standard.cv=TRUE,#
                               na.rm=TRUE,#
                               species.type="PlantGenusSpecies")#
summary(plants.degree.k.cv$lm.nss)#
#
## pollinators and closeness#
## sig#
degree.closeness.cv <- cv.trait(spec,#
                                specs[specs$speciesType =="pollinator",],#
                                trait="degree",#
                                method= "time", time.col="assem",#
                                abund.col="weighted.closeness",#
                                cv.function=cv,#
                                zero2na=TRUE,#
                                standard.cv=TRUE,#
                                na.rm=TRUE)#
summary(degree.closeness.cv$lm.nss)#
#
## plants and closeness#
## not sig!#
plants.degree.closeness.cv <- cv.trait(spec,#
                                       specs[specs$speciesType =="plant",],#
                                       trait="plant.degree",#
                                       method= "time", time.col="assem",#
                                       abund.col="weighted.closeness",#
                                       cv.function=cv,#
                                       zero2na=TRUE,#
                                       standard.cv=TRUE,#
                                       na.rm=TRUE,#
                                       species.type="PlantGenusSpecies")#
summary(plants.degree.closeness.cv$lm.nss)#
## check correlation of degree and occ #
## pollinators#
occ.k.sd$data$degree <-#
  degree$data$traits.ns[match(occ.k.sd$data$GenusSpecies,#
                              degree$data$GenusSpecies)]#
#
plot(occ.k.sd$data$traits.ns ~ occ.k.sd$data$degree)#
#
cor.test(occ.k.sd$data$traits.ns, occ.k.sd$data$degree)
spec$degree
occ.k.sd$data$degree <-#
  spec$degree[match(occ.k.sd$data$GenusSpecies,#
                              spec$GenusSpecies)]
plot(unique(cbind(spec$degree, spec$occ.date)))
cor.test(unique(cbind(spec$degree, spec$occ.date)))
## check correlation of degree and occ #
## pollinators#
check.pol <- unique(cbind(spec$degree, spec$occ.date))#
plot(check.pol)#
#
cor.test(check.pol[,1], check.pol[,2])
check.plant <- unique(cbind(spec$plant.degree, spec$occ.plant.date))#
plot(check.plant)
cor.test(check.plant[,1], check.plant[,2])
cor.test(check.pol[,1], check.pol[,2])
plants.occ.closeness.cv <- cv.trait(spec,#
                                    specs[specs$speciesType =="plant",],#
                                    trait="occ.plant.date",#
                                    method= "time", time.col="assem",#
                                    abund.col="weighted.closeness",#
                                    cv.function=cv,#
                                    zero2na=TRUE,#
                                    standard.cv=TRUE,#
                                    na.rm=TRUE,#
                                    species.type="PlantGenusSpecies")#
summary(plants.occ.closeness.cv$lm.nss)
plants.degree.closeness.cv <- cv.trait(spec,#
                                       specs[specs$speciesType =="plant",],#
                                       trait="plant.degree",#
                                       method= "time", time.col="assem",#
                                       abund.col="weighted.closeness",#
                                       cv.function=cv,#
                                       zero2na=TRUE,#
                                       standard.cv=TRUE,#
                                       na.rm=TRUE,#
                                       species.type="PlantGenusSpecies")#
summary(plants.degree.closeness.cv$lm.nss)
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
binary <- FALSE#
alpha <- TRUE#
## int or pols#
type <- "pols"#
source('src/initialize_beta.R')
load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
       paste(dis.method, alpha, occ, type, sep='_'))))#
mod.pols <- lmer(dist ~ status +  (1|site),#
                 data=dats.pols)#
summary(mod.pols)
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
binary <- FALSE#
alpha <- TRUE#
## int or pols#
type <- "int"#
source('src/initialize_beta.R')
load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
       paste(dis.method, alpha, occ, type, sep='_'))))
mod.pols <- lmer(dist ~ status +  (1|site),#
                 data=dats.pols)#
summary(mod.pols)
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
source('src/initialize.R')#
source('src/phyloIntBeta.R')#
source('src/plotDists.R')#
#
## ************************************************************#
## prepare link community in terminal#
## ************************************************************#
edges.com <- aggregate(list(abund=spec$GenusSpecies),#
                       list(GenusSpecies=spec$GenusSpecies,#
                            PlantGenusSpecies=spec$PlantGenusSpecies),#
                       length)#
#
## lc <- getLinkCommunities(edges.com,#
##                          hcmethod = "average",#
##                          bipartite=TRUE)#
## save(lc, file="saved/lc.Rdata")
## mature and maturing hedgerows have more intearction turnover#
## between years#
load(file="saved/phyloInt.Rdata")#
phylo.int.mod <- lmer(PhyloInt ~ SiteStatus +#
                      (1|Site),#
                      data=phylo.int$phylo.int)#
summary(phylo.int.mod)
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/speciesLevel')#
source('plotting/src/predictIntervals.R')#
source('plotting/src/CIplotting.R')#
source('plotting/src/plotPanels.R')#
source('src/initialize.R')#
#
## ************************************************************#
## specialization#
## ************************************************************#
#
load(file=file.path(save.path, 'specs.Rdata'))#
load(file=file.path(save.path, "mods/specs_ypr.Rdata"))#
#
ylabs <- c("Proportional Generality", "Specialization (d')", "Degree",#
           "Betweenness", "Closeness" )#
#
dd <- expand.grid(ypr=seq(from= min(specs$ypr, na.rm=TRUE),#
                          to= max(specs$ypr, na.rm=TRUE),#
                          length=10))#
pp <- c("plants", "pols")#
mods <- list(mod.pols, mod.plants)#
names(mods) <- pp#
#
for(j in pp){#
  for(i in 1:length(ys)){#
    dd.ypr <- cbind(dd, 0)#
    colnames(dd.ypr) <- c("ypr", ys[i])#
      ypr.pi <- predict.int(mod= mods[[j]][[i]],#
                            dd=dd.ypr,#
                            y=ys[i],#
                            family="gaussian")#
#
    plot.predict.ypr(new.dd=ypr.pi,#
                     ylabel=ylabs[i],#
                     dats=specs,#
                     y1=ys[i],#
                     extinction.method=j,#
                     agg.col="GenusSpecies")#
  }#
}#
## closeness only#
#
ypr.pi.pol <- predict.int(mod= mods$pol$closeness,#
                      dd=dd.ypr,#
                      y="closeness",#
                      family="gaussian")#
ypr.pi.plant <- predict.int(mod= mods$plant$closeness,#
                      dd=dd.ypr,#
                      y="closeness",#
                      family="gaussian")#
#
plot.panels()
mod.pols$closeness
summary(mod.pols$closeness)
summary(mod.plants$closeness)
1-var(residuals(mod.pols$closeness))/(var(model.response(model.frame(mod.pols$closeness)))
)
library(glmmadmb)
library(glmmADMB)
mod.pols <- lapply(formulas, function(x){#
  glmmadmb(x,#
       data=specs[specs$speciesType == "pollinator",])#
})
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/speciesLevel')#
source('src/initialize.R')#
load('../../data/networks/all_networks_years.Rdata')#
#
## **********************************************************#
## species importance#
## **********************************************************#
## specs <- calcSpec(nets, spec, spec.metric = "d", 0.3)#
## save(specs, file=file.path(save.path, 'specs.Rdata'))#
#
## linear models#
load(file=file.path(save.path, 'specs.Rdata'))#
## SiteStatus or ypr#
xvar <- "ypr"#
#
## anything outputted by specieslevel#
ys <- c("proportional.generality", "d", "degree", "betweenness",#
        "closeness")#
#
## formulas <-lapply(ys, function(x) {#
##   as.formula(paste(x, "~",#
##                    paste(paste(xvar, "specialization", sep="*"), #
##                          "(1|Site)",#
##                           "(1|GenusSpecies)",#
##                          sep="+")))#
## })#
#
formulas <-lapply(ys, function(x) {#
  as.formula(paste(x, "~",#
                   paste(xvar, #
                         "(1|Site)",#
                          "(1|GenusSpecies)",#
                         sep="+")))#
})#
#
mod.pols <- lapply(formulas, function(x){#
  glmmadmb(x,#
       data=specs[specs$speciesType == "pollinator",])#
})
mod.pols <- lapply(formulas, function(x){#
  glmmadmb(x,#
       data=specs[specs$speciesType == "pollinator",],#
           family="gaussian")#
})
specs$Site <- as.factor(spec$Site)#
specs$GenusSpecies <- as.factor(spec$GenusSpecies)#
formulas <-lapply(ys, function(x) {#
  as.formula(paste(x, "~",#
                   paste(xvar, #
                         "(1|Site)",#
                          "(1|GenusSpecies)",#
                         sep="+")))#
})#
#
mod.pols <- lapply(formulas, function(x){#
  glmmadmb(x,#
       data=specs[specs$speciesType == "pollinator",],#
           family="gaussian")#
})
specs$Site <- factor(spec$Site)#
specs$GenusSpecies <- factor(spec$GenusSpecies)#
formulas <-lapply(ys, function(x) {#
  as.formula(paste(x, "~",#
                   paste(xvar, #
                         "(1|Site)",#
                          "(1|GenusSpecies)",#
                         sep="+")))#
})#
#
mod.pols <- lapply(formulas, function(x){#
  glmmadmb(x,#
       data=specs[specs$speciesType == "pollinator",],#
           family="gaussian")#
})
class(spec4Site)
class(specs$Site)
specs$Site <- factor(specs$Site)#
specs$GenusSpecies <- factor(specs$GenusSpecies)#
formulas <-lapply(ys, function(x) {#
  as.formula(paste(x, "~",#
                   paste(xvar, #
                         "(1|Site)",#
                          "(1|GenusSpecies)",#
                         sep="+")))#
})#
#
mod.pols <- lapply(formulas, function(x){#
  glmmadmb(x,#
       data=specs[specs$speciesType == "pollinator",],#
           family="gaussian")#
})
mod.pols <- lapply(formulas, function(x){#
  lmer(x,#
       data=specs[specs$speciesType == "pollinator",])#
})
lapply(mod.pols, summary)
lapply(mod.plantss, summary)
lapply(mod.plants, summary)
lapply(mod.plant, summary)
mod.plants <- lapply(formulas, function(x){#
  lmer(x,#
       data=specs[specs$speciesType == "plant",])#
})#
names(mod.pols) <- names(mod.plants) <- ys
lapply(mod.plant, summary)
lapply(mod.plants, summary)
lapply(mod.pols, summary)
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/networkLevel')#
source('src/initialize.R')#
load('../../data/networks/baci_networks_years.Rdata')#
N <- 99#
#
## ## ************************************************************#
## ## calculate metrics and zscores#
## ## ************************************************************#
## mets <- lapply(nets, network.metrics, N)#
#
## cor.dats <- prep.dat(mets,  spec)#
#
## cor.dats$tot.rich <- cor.dats$number.of.species.LL +#
##   cor.dats$number.of.species.HL#
#
## save(cor.dats, file='saved/corMets.Rdata')#
#
## ************************************************************#
## effect of years post restoration#
## ************************************************************#
load(file='saved/corMets.Rdata')
## connectance#
baci.conn.mod <- lmer(connectance ~ scale(ypr) +#
                 (1|Site) + (1|Year),#
                 data=cor.dats[!is.na(cor.dats$ypr),])#
summary(baci.conn.mod)#
save(baci.conn.mod, file='saved/mods/baci_conn.Rdata')
## weighted connectance#
baci.wconn.mod <- lmer(weighted.connectance ~ scale(ypr) +#
                 (1|Site) + (1|Year),#
                 data=cor.dats[!is.na(cor.dats$ypr),])#
summary(baci.wconn.mod)#
save(baci.wconn.mod, file='saved/mods/baci_wconn.Rdata')
?networklevel
## species richness pol#
baci.rich.hl.mod <- glmer(number.of.species.HL ~ scale(ypr) +#
                 (1|Site) + (1|Year), family="poisson",#
                 data=cor.dats[!is.na(cor.dats$ypr),])#
summary(baci.rich.hl.mod)#
save(baci.rich.hl.mod, file='saved/mods/baci_rich_hl.Rdata')#
#
## species richness plants#
baci.rich.ll.mod <- glmer(number.of.species.LL ~ scale(ypr) +#
                 (1|Site) + (1|Year), family="poisson",#
                 data=cor.dats[!is.na(cor.dats$ypr),])#
summary(baci.rich.ll.mod)#
save(baci.rich.ll.mod, file='saved/mods/baci_rich_ll.Rdata')
rm(list=ls())#
library(vegan)#
library(bipartite)#
library(fields)#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
source('src/initialize.R')#
source('src/commPrep.R')#
save.dir.comm <- "saved/communities"#
save.dir.nulls <- "saved/nulls"#
nnull <- 99#
#
src.dir2 <- '~/Dropbox/hedgerow_network/analysis/beta-div'#
source(file.path(src.dir2, 'src/misc.R'))#
source(file.path(src.dir2, 'src/vaznull2.R'))#
sites <- unique(spec$Site)#
spec$Int <- paste(spec$GenusSpecies,#
                  spec$PlantGenusSpecies)#
## pols, int or plants#
type <- "plants"#
if(type=="pols"){#
  species.type="GenusSpecies"#
}#
if(type=="int"){#
  species.type="Int"#
}#
if(type=="plants"){#
  species.type="PlantGenusSpecies"#
}
comms <- lapply(sites, calcYearBeta,#
                species.type=species.type,#
                spec=spec)#
comm <- makePretty(comms, sites, spec)#
#
save(comm, file=file.path(save.dir.comm,#
             sprintf('%s-abund.Rdata', type)))
## ************************************************************#
## occurrence nulls#
## ************************************************************#
load(file=file.path(save.dir.comm,#
       sprintf('%s-abund.Rdata', type)))#
nulls <- lapply(comm$comm, function(x){#
  replicate(nnull, commsimulator(x, method= 'quasiswap'),#
            simplify= FALSE)#
})#
save(nulls, file=file.path(save.dir.nulls,#
              sprintf('%s-occ.Rdata', type)))
load(file=file.path(save.dir.comm,#
       sprintf('%s-abund.Rdata', type)))#
nulls <- lapply(comm$comm, function(x){#
  replicate(nnull, commsimulator(x, method= 'quasiswap'),#
            simplify= FALSE)#
})#
save(nulls, file=file.path(save.dir.nulls,#
              sprintf('%s-occ.Rdata', type)))
load(file=file.path(save.dir.comm,#
       sprintf('%s-abund.Rdata', type)))#
nulls <- lapply(comm$comm, vaznull.2, N=nnull)#
save(nulls, file=file.path(save.dir.nulls,#
              sprintf('%s-alpha.Rdata', type)))
## ************************************************************#
## individuals nulls#
## ************************************************************#
load(file=file.path(save.dir.comm,#
       sprintf('%s-abund.Rdata', type)))#
nulls <- lapply(comm$comm, swap.web, N=nnull)#
save(nulls, file=file.path(save.dir.nulls,#
              sprintf('%s-indiv.Rdata', type)))
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
binary <- FALSE#
alpha <- TRUE#
## int or pols#
type <- "int"#
source('src/initialize_beta.R')#
#
## ************************************************************#
## beta diversity as variation between years,#
## centroid for each site#
## ************************************************************#
dis <- mapply(function(a, b, c, d)#
              beta.status(comm= a,#
                          status= b,#
                          dis.method,#
                          nulls=c,#
                          occ=binary,#
                          years=d,#
                          sub=type),#
              a=comm$comm,#
              b=comm$status,#
              c= nulls,#
              d= comm$comm,#
              SIMPLIFY=FALSE)#
#
dats <- data.frame(site=comm$sites,#
                   status=unlist(comm$status),#
                   year=unlist(comm$years),#
                   dist=unlist(sapply(dis, function(x)#
                     x$distances)))#
rownames(dats) <- NULL#
#
save(dats, file= file.path('saved/speciesTurnover',#
             sprintf('%s.pdf', paste(dis.method, alpha, occ, type,#
                                     sep='_'))))#
#
## invid nulls all not sig, alpha nulls mature marginally sig less,#
## occurrence nulls all not sig#
#
## run model, plot#
#
load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
       paste(dis.method, alpha, occ, type, sep='_'))))#
mod <- lmer(dist ~ status +  (1|site),#
            data=dats)#
summary(mod)#
#
plot.beta.div(dis.method =dis.method, dists= dats$dist,#
              status= dats$status, type= "time",#
              sub= type, occ=occ, ylabel=ylabel)#
#
plot.coeffs(dis.method =dis.method, mod=summary(mod),#
            status= dats$status, type= "space",#
            sub= type, occ=occ)
rm(list=ls())#
library(vegan)#
library(bipartite)#
library(fields)#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
source('src/initialize.R')#
source('src/commPrep.R')#
save.dir.comm <- "saved/communities"#
save.dir.nulls <- "saved/nulls"#
nnull <- 99#
#
src.dir2 <- '~/Dropbox/hedgerow_network/analysis/beta-div'#
source(file.path(src.dir2, 'src/misc.R'))#
source(file.path(src.dir2, 'src/vaznull2.R'))#
sites <- unique(spec$Site)#
spec$Int <- paste(spec$GenusSpecies,#
                  spec$PlantGenusSpecies)#
## pols, int or plants#
type <- "int"#
if(type=="pols"){#
  species.type="GenusSpecies"#
}#
if(type=="int"){#
  species.type="Int"#
}#
if(type=="plants"){#
  species.type="PlantGenusSpecies"#
}#
#
## ************************************************************#
## year by species matrices pollinators!#
## ************************************************************#
comms <- lapply(sites, calcYearBeta,#
                species.type=species.type,#
                spec=spec)#
comm <- makePretty(comms, sites, spec)#
#
save(comm, file=file.path(save.dir.comm,#
             sprintf('%s-abund.Rdata', type)))#
#
## ************************************************************#
## occurrence nulls#
## ************************************************************#
load(file=file.path(save.dir.comm,#
       sprintf('%s-abund.Rdata', type)))#
nulls <- lapply(comm$comm, function(x){#
  replicate(nnull, commsimulator(x, method= 'quasiswap'),#
            simplify= FALSE)#
})#
save(nulls, file=file.path(save.dir.nulls,#
              sprintf('%s-occ.Rdata', type)))#
#
## ************************************************************#
## alpha div nulls#
## ************************************************************#
load(file=file.path(save.dir.comm,#
       sprintf('%s-abund.Rdata', type)))#
nulls <- lapply(comm$comm, vaznull.2, N=nnull)#
save(nulls, file=file.path(save.dir.nulls,#
              sprintf('%s-alpha.Rdata', type)))#
#
## ************************************************************#
## individuals nulls#
## ************************************************************#
load(file=file.path(save.dir.comm,#
       sprintf('%s-abund.Rdata', type)))#
nulls <- lapply(comm$comm, swap.web, N=nnull)#
save(nulls, file=file.path(save.dir.nulls,#
              sprintf('%s-indiv.Rdata', type)))
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
binary <- FALSE#
alpha <- TRUE#
## int or pols#
type <- "int"#
source('src/initialize_beta.R')#
#
## ************************************************************#
## beta diversity as variation between years,#
## centroid for each site#
## ************************************************************#
dis <- mapply(function(a, b, c, d)#
              beta.status(comm= a,#
                          status= b,#
                          dis.method,#
                          nulls=c,#
                          occ=binary,#
                          years=d,#
                          sub=type),#
              a=comm$comm,#
              b=comm$status,#
              c= nulls,#
              d= comm$comm,#
              SIMPLIFY=FALSE)#
#
dats <- data.frame(site=comm$sites,#
                   status=unlist(comm$status),#
                   year=unlist(comm$years),#
                   dist=unlist(sapply(dis, function(x)#
                     x$distances)))#
rownames(dats) <- NULL#
#
save(dats, file= file.path('saved/speciesTurnover',#
             sprintf('%s.pdf', paste(dis.method, alpha, occ, type,#
                                     sep='_'))))#
#
## invid nulls all not sig, alpha nulls mature marginally sig less,#
## occurrence nulls all not sig#
#
## run model, plot#
#
load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
       paste(dis.method, alpha, occ, type, sep='_'))))#
mod <- lmer(dist ~ status +  (1|site),#
            data=dats)#
summary(mod)#
#
plot.beta.div(dis.method =dis.method, dists= dats$dist,#
              status= dats$status, type= "time",#
              sub= type, occ=occ, ylabel=ylabel)#
#
plot.coeffs(dis.method =dis.method, mod=summary(mod),#
            status= dats$status, type= "space",#
            sub= type, occ=occ)#
## plotDistPanels()
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
binary <- FALSE#
alpha <- TRUE#
## int or pols#
type <- "plants"#
source('src/initialize_beta.R')#
#
## ************************************************************#
## beta diversity as variation between years,#
## centroid for each site#
## ************************************************************#
dis <- mapply(function(a, b, c, d)#
              beta.status(comm= a,#
                          status= b,#
                          dis.method,#
                          nulls=c,#
                          occ=binary,#
                          years=d,#
                          sub=type),#
              a=comm$comm,#
              b=comm$status,#
              c= nulls,#
              d= comm$comm,#
              SIMPLIFY=FALSE)#
#
dats <- data.frame(site=comm$sites,#
                   status=unlist(comm$status),#
                   year=unlist(comm$years),#
                   dist=unlist(sapply(dis, function(x)#
                     x$distances)))#
rownames(dats) <- NULL#
#
save(dats, file= file.path('saved/speciesTurnover',#
             sprintf('%s.pdf', paste(dis.method, alpha, occ, type,#
                                     sep='_'))))#
#
## invid nulls all not sig, alpha nulls mature marginally sig less,#
## occurrence nulls all not sig#
#
## run model, plot#
#
load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
       paste(dis.method, alpha, occ, type, sep='_'))))#
mod <- lmer(dist ~ status +  (1|site),#
            data=dats)#
summary(mod)#
#
plot.beta.div(dis.method =dis.method, dists= dats$dist,#
              status= dats$status, type= "time",#
              sub= type, occ=occ, ylabel=ylabel)#
#
plot.coeffs(dis.method =dis.method, mod=summary(mod),#
            status= dats$status, type= "space",#
            sub= type, occ=occ)#
## plotDistPanels()
plotDistPanels()
source('src/initialize_beta.R')
plotDistPanels()
library(RColorBrewer)#
library(beeswarm)#
## box plot#
#
plot.beta.div <- function(dis.method, ## dissmiliarity method for file name#
                          dists, ## beta-div estimate (box data)#
                          status, ## vector of site statuses (box catagoties)#
                          type, ## time or space for ylab#
                          sub, ## bees/syrphids for file name#
                          occ,## occ data? TRUE/FALSE#
                          fig.path = 'figures/betadisper',#
                          ylabel){#
  makeBetaBox <- function(){#
#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1,#
            ylim=c(0,1))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
#
    mtext(ylabel,#
          2, line=3.5, cex=1.5)#
#
  }#
  pdf.f(makeBetaBox,#
        file= file.path(fig.path, sprintf('%s.pdf',#
          paste(type,#
                occ,#
                dis.method,#
                sub,#
                sep='_'))),#
        width=6, height=6)#
}#
#
## extracts model coefficients and SE and plots them as points and#
## lines#
#
plot.coeffs <- function(dis.method, ## dissmiliarity method for file name#
                        mod, ## model object#
                        status, ## vector of site statuses #
                        type,  ## time or space for ylab#
                        sub, ## bees/syrphids for file name#
                        occ, ## occ data? TRUE/FALSE#
                        fig.path = 'figures/betadisper',#
                        add.labels=TRUE){  #
  ## cols <-brewer.pal(6, 'Dark2')[c(6,2,1)]#
  cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
  f <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    means <- c(coef(mod)[1,1],#
               coef(mod)[1,1] + coef(mod)[3,1],#
               coef(mod)[1,1] + coef(mod)[2,1])#
    ci.ub <- means +#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    ci.lb <- means -#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    plot(x=1:3, y=means,#
         col=cols,#
         pch=16,#
         ylim=c(0,0.6),#
         xlim=c(0.5,3.5),#
         xlab='',#
         xaxt='n',#
         cex=1.5, las=1)#
    arrows(x0=1:3,#
           y0= ci.lb, y1=ci.ub, angle=90,#
           length=0, code=3, col=cols, lwd=1.5)#
    mtext("Species temporal turnover", 2, line=3.5 , cex=2)#
    if(add.labels){#
      axis(1, at= 1:3,#
           labels=c("Non-assembling \n field margin",#
             "Assembling \n  hedgerow",#
             "Non-assembling \n hedgerow"))#
    }#
  }#
  pdf.f(f, file= file.path(fig.path, sprintf('%s.pdf',#
             paste('coeff', type,#
                   occ,#
                   dis.method,#
                   sub,#
                   sep='_'))),#
        width=6, height=6)#
}#
plot.node.box <- function(ylabel,#
                          dats,#
                          y1){#
  makeNodeBox <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext(ylabel, 2, line=3.5, cex=1.5)#
  }#
  path <- 'figures'#
  pdf.f(makeNodeBox, file=file.path(path,#
                       sprintf("%s.pdf", paste(#
                         gsub(" ", "", ylabel),#
                         "box", sep="_"))),#
        width=6, height=6)#
}#
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2 byrow=TRUE))#
    par(oma=c(5, 6.5, 0.5, 1),#
        mar=c(3, 4, 0, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinator species turnover",#
          3, line=2, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="b")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plant species turnover",#
          3, line=2, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interaction turnover",#
          3, line=2, cex=1.2)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 3, at = 1:3, cex=1.1)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interaction turnover", 2, line=4, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=5, height=5)#
}
library(RColorBrewer)#
library(beeswarm)#
## box plot#
#
plot.beta.div <- function(dis.method, ## dissmiliarity method for file name#
                          dists, ## beta-div estimate (box data)#
                          status, ## vector of site statuses (box catagoties)#
                          type, ## time or space for ylab#
                          sub, ## bees/syrphids for file name#
                          occ,## occ data? TRUE/FALSE#
                          fig.path = 'figures/betadisper',#
                          ylabel){#
  makeBetaBox <- function(){#
#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1,#
            ylim=c(0,1))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
#
    mtext(ylabel,#
          2, line=3.5, cex=1.5)#
#
  }#
  pdf.f(makeBetaBox,#
        file= file.path(fig.path, sprintf('%s.pdf',#
          paste(type,#
                occ,#
                dis.method,#
                sub,#
                sep='_'))),#
        width=6, height=6)#
}#
#
## extracts model coefficients and SE and plots them as points and#
## lines#
#
plot.coeffs <- function(dis.method, ## dissmiliarity method for file name#
                        mod, ## model object#
                        status, ## vector of site statuses #
                        type,  ## time or space for ylab#
                        sub, ## bees/syrphids for file name#
                        occ, ## occ data? TRUE/FALSE#
                        fig.path = 'figures/betadisper',#
                        add.labels=TRUE){  #
  ## cols <-brewer.pal(6, 'Dark2')[c(6,2,1)]#
  cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
  f <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    means <- c(coef(mod)[1,1],#
               coef(mod)[1,1] + coef(mod)[3,1],#
               coef(mod)[1,1] + coef(mod)[2,1])#
    ci.ub <- means +#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    ci.lb <- means -#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    plot(x=1:3, y=means,#
         col=cols,#
         pch=16,#
         ylim=c(0,0.6),#
         xlim=c(0.5,3.5),#
         xlab='',#
         xaxt='n',#
         cex=1.5, las=1)#
    arrows(x0=1:3,#
           y0= ci.lb, y1=ci.ub, angle=90,#
           length=0, code=3, col=cols, lwd=1.5)#
    mtext("Species temporal turnover", 2, line=3.5 , cex=2)#
    if(add.labels){#
      axis(1, at= 1:3,#
           labels=c("Non-assembling \n field margin",#
             "Assembling \n  hedgerow",#
             "Non-assembling \n hedgerow"))#
    }#
  }#
  pdf.f(f, file= file.path(fig.path, sprintf('%s.pdf',#
             paste('coeff', type,#
                   occ,#
                   dis.method,#
                   sub,#
                   sep='_'))),#
        width=6, height=6)#
}#
plot.node.box <- function(ylabel,#
                          dats,#
                          y1){#
  makeNodeBox <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext(ylabel, 2, line=3.5, cex=1.5)#
  }#
  path <- 'figures'#
  pdf.f(makeNodeBox, file=file.path(path,#
                       sprintf("%s.pdf", paste(#
                         gsub(" ", "", ylabel),#
                         "box", sep="_"))),#
        width=6, height=6)#
}#
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2 byrow=TRUE))#
    par(oma=c(5, 6.5, 0.5, 1),#
        mar=c(3, 4, 0, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinator species turnover",#
          3, line=2, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plant species turnover",#
          3, line=2, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interaction turnover",#
          3, line=2, cex=1.2)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 3, at = 1:3, cex=1.1)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interaction turnover", 2, line=4, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=5, height=5)#
}
library(RColorBrewer)#
library(beeswarm)#
## box plot#
#
plot.beta.div <- function(dis.method, ## dissmiliarity method for file name#
                          dists, ## beta-div estimate (box data)#
                          status, ## vector of site statuses (box catagoties)#
                          type, ## time or space for ylab#
                          sub, ## bees/syrphids for file name#
                          occ,## occ data? TRUE/FALSE#
                          fig.path = 'figures/betadisper',#
                          ylabel){#
  makeBetaBox <- function(){#
#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1,#
            ylim=c(0,1))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
#
    mtext(ylabel,#
          2, line=3.5, cex=1.5)#
#
  }#
  pdf.f(makeBetaBox,#
        file= file.path(fig.path, sprintf('%s.pdf',#
          paste(type,#
                occ,#
                dis.method,#
                sub,#
                sep='_'))),#
        width=6, height=6)#
}#
#
## extracts model coefficients and SE and plots them as points and#
## lines#
#
plot.coeffs <- function(dis.method, ## dissmiliarity method for file name#
                        mod, ## model object#
                        status, ## vector of site statuses #
                        type,  ## time or space for ylab#
                        sub, ## bees/syrphids for file name#
                        occ, ## occ data? TRUE/FALSE#
                        fig.path = 'figures/betadisper',#
                        add.labels=TRUE){  #
  ## cols <-brewer.pal(6, 'Dark2')[c(6,2,1)]#
  cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
  f <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    means <- c(coef(mod)[1,1],#
               coef(mod)[1,1] + coef(mod)[3,1],#
               coef(mod)[1,1] + coef(mod)[2,1])#
    ci.ub <- means +#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    ci.lb <- means -#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    plot(x=1:3, y=means,#
         col=cols,#
         pch=16,#
         ylim=c(0,0.6),#
         xlim=c(0.5,3.5),#
         xlab='',#
         xaxt='n',#
         cex=1.5, las=1)#
    arrows(x0=1:3,#
           y0= ci.lb, y1=ci.ub, angle=90,#
           length=0, code=3, col=cols, lwd=1.5)#
    mtext("Species temporal turnover", 2, line=3.5 , cex=2)#
    if(add.labels){#
      axis(1, at= 1:3,#
           labels=c("Non-assembling \n field margin",#
             "Assembling \n  hedgerow",#
             "Non-assembling \n hedgerow"))#
    }#
  }#
  pdf.f(f, file= file.path(fig.path, sprintf('%s.pdf',#
             paste('coeff', type,#
                   occ,#
                   dis.method,#
                   sub,#
                   sep='_'))),#
        width=6, height=6)#
}#
plot.node.box <- function(ylabel,#
                          dats,#
                          y1){#
  makeNodeBox <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext(ylabel, 2, line=3.5, cex=1.5)#
  }#
  path <- 'figures'#
  pdf.f(makeNodeBox, file=file.path(path,#
                       sprintf("%s.pdf", paste(#
                         gsub(" ", "", ylabel),#
                         "box", sep="_"))),#
        width=6, height=6)#
}#
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(5, 6.5, 0.5, 1),#
        mar=c(3, 4, 0, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinator species turnover",#
          3, line=2, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plant species turnover",#
          3, line=2, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interaction turnover",#
          3, line=2, cex=1.2)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 3, at = 1:3, cex=1.1)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interaction turnover", 2, line=4, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=5, height=5)#
}
library(RColorBrewer)#
library(beeswarm)#
## box plot#
#
plot.beta.div <- function(dis.method, ## dissmiliarity method for file name#
                          dists, ## beta-div estimate (box data)#
                          status, ## vector of site statuses (box catagoties)#
                          type, ## time or space for ylab#
                          sub, ## bees/syrphids for file name#
                          occ,## occ data? TRUE/FALSE#
                          fig.path = 'figures/betadisper',#
                          ylabel){#
  makeBetaBox <- function(){#
#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1,#
            ylim=c(0,1))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
#
    mtext(ylabel,#
          2, line=3.5, cex=1.5)#
#
  }#
  pdf.f(makeBetaBox,#
        file= file.path(fig.path, sprintf('%s.pdf',#
          paste(type,#
                occ,#
                dis.method,#
                sub,#
                sep='_'))),#
        width=6, height=6)#
}#
#
## extracts model coefficients and SE and plots them as points and#
## lines#
#
plot.coeffs <- function(dis.method, ## dissmiliarity method for file name#
                        mod, ## model object#
                        status, ## vector of site statuses #
                        type,  ## time or space for ylab#
                        sub, ## bees/syrphids for file name#
                        occ, ## occ data? TRUE/FALSE#
                        fig.path = 'figures/betadisper',#
                        add.labels=TRUE){  #
  ## cols <-brewer.pal(6, 'Dark2')[c(6,2,1)]#
  cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
  f <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    means <- c(coef(mod)[1,1],#
               coef(mod)[1,1] + coef(mod)[3,1],#
               coef(mod)[1,1] + coef(mod)[2,1])#
    ci.ub <- means +#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    ci.lb <- means -#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    plot(x=1:3, y=means,#
         col=cols,#
         pch=16,#
         ylim=c(0,0.6),#
         xlim=c(0.5,3.5),#
         xlab='',#
         xaxt='n',#
         cex=1.5, las=1)#
    arrows(x0=1:3,#
           y0= ci.lb, y1=ci.ub, angle=90,#
           length=0, code=3, col=cols, lwd=1.5)#
    mtext("Species temporal turnover", 2, line=3.5 , cex=2)#
    if(add.labels){#
      axis(1, at= 1:3,#
           labels=c("Non-assembling \n field margin",#
             "Assembling \n  hedgerow",#
             "Non-assembling \n hedgerow"))#
    }#
  }#
  pdf.f(f, file= file.path(fig.path, sprintf('%s.pdf',#
             paste('coeff', type,#
                   occ,#
                   dis.method,#
                   sub,#
                   sep='_'))),#
        width=6, height=6)#
}#
plot.node.box <- function(ylabel,#
                          dats,#
                          y1){#
  makeNodeBox <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext(ylabel, 2, line=3.5, cex=1.5)#
  }#
  path <- 'figures'#
  pdf.f(makeNodeBox, file=file.path(path,#
                       sprintf("%s.pdf", paste(#
                         gsub(" ", "", ylabel),#
                         "box", sep="_"))),#
        width=6, height=6)#
}#
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2 byrow=TRUE))#
    par(oma=c(5, 6.5, 0.5, 1),#
        mar=c(3, 4, 0, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinator species turnover",#
          3, line=2, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plant species turnover",#
          3, line=2, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interaction turnover",#
          3, line=2, cex=1.2)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 3, at = 1:3, cex=1.1)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interaction turnover", 2, line=4, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=5, height=5)#
}
library(RColorBrewer)#
library(beeswarm)#
## box plot#
#
plot.beta.div <- function(dis.method, ## dissmiliarity method for file name#
                          dists, ## beta-div estimate (box data)#
                          status, ## vector of site statuses (box catagoties)#
                          type, ## time or space for ylab#
                          sub, ## bees/syrphids for file name#
                          occ,## occ data? TRUE/FALSE#
                          fig.path = 'figures/betadisper',#
                          ylabel){#
  makeBetaBox <- function(){#
#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1,#
            ylim=c(0,1))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
#
    mtext(ylabel,#
          2, line=3.5, cex=1.5)#
#
  }#
  pdf.f(makeBetaBox,#
        file= file.path(fig.path, sprintf('%s.pdf',#
          paste(type,#
                occ,#
                dis.method,#
                sub,#
                sep='_'))),#
        width=6, height=6)#
}#
#
## extracts model coefficients and SE and plots them as points and#
## lines#
#
plot.coeffs <- function(dis.method, ## dissmiliarity method for file name#
                        mod, ## model object#
                        status, ## vector of site statuses #
                        type,  ## time or space for ylab#
                        sub, ## bees/syrphids for file name#
                        occ, ## occ data? TRUE/FALSE#
                        fig.path = 'figures/betadisper',#
                        add.labels=TRUE){  #
  ## cols <-brewer.pal(6, 'Dark2')[c(6,2,1)]#
  cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
  f <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    means <- c(coef(mod)[1,1],#
               coef(mod)[1,1] + coef(mod)[3,1],#
               coef(mod)[1,1] + coef(mod)[2,1])#
    ci.ub <- means +#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    ci.lb <- means -#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    plot(x=1:3, y=means,#
         col=cols,#
         pch=16,#
         ylim=c(0,0.6),#
         xlim=c(0.5,3.5),#
         xlab='',#
         xaxt='n',#
         cex=1.5, las=1)#
    arrows(x0=1:3,#
           y0= ci.lb, y1=ci.ub, angle=90,#
           length=0, code=3, col=cols, lwd=1.5)#
    mtext("Species temporal turnover", 2, line=3.5 , cex=2)#
    if(add.labels){#
      axis(1, at= 1:3,#
           labels=c("Non-assembling \n field margin",#
             "Assembling \n  hedgerow",#
             "Non-assembling \n hedgerow"))#
    }#
  }#
  pdf.f(f, file= file.path(fig.path, sprintf('%s.pdf',#
             paste('coeff', type,#
                   occ,#
                   dis.method,#
                   sub,#
                   sep='_'))),#
        width=6, height=6)#
}#
plot.node.box <- function(ylabel,#
                          dats,#
                          y1){#
  makeNodeBox <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext(ylabel, 2, line=3.5, cex=1.5)#
  }#
  path <- 'figures'#
  pdf.f(makeNodeBox, file=file.path(path,#
                       sprintf("%s.pdf", paste(#
                         gsub(" ", "", ylabel),#
                         "box", sep="_"))),#
        width=6, height=6)#
}#
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(5, 6.5, 0.5, 1),#
        mar=c(3, 4, 0, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinator species turnover",#
          3, line=2, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plant species turnover",#
          3, line=2, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interaction turnover",#
          3, line=2, cex=1.2)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 3, at = 1:3, cex=1.1)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interaction turnover", 2, line=4, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=5, height=5)#
}
plotDistPanels()
library(RColorBrewer)#
library(beeswarm)#
## box plot#
#
plot.beta.div <- function(dis.method, ## dissmiliarity method for file name#
                          dists, ## beta-div estimate (box data)#
                          status, ## vector of site statuses (box catagoties)#
                          type, ## time or space for ylab#
                          sub, ## bees/syrphids for file name#
                          occ,## occ data? TRUE/FALSE#
                          fig.path = 'figures/betadisper',#
                          ylabel){#
  makeBetaBox <- function(){#
#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1,#
            ylim=c(0,1))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
#
    mtext(ylabel,#
          2, line=3.5, cex=1.5)#
#
  }#
  pdf.f(makeBetaBox,#
        file= file.path(fig.path, sprintf('%s.pdf',#
          paste(type,#
                occ,#
                dis.method,#
                sub,#
                sep='_'))),#
        width=6, height=6)#
}#
#
## extracts model coefficients and SE and plots them as points and#
## lines#
#
plot.coeffs <- function(dis.method, ## dissmiliarity method for file name#
                        mod, ## model object#
                        status, ## vector of site statuses #
                        type,  ## time or space for ylab#
                        sub, ## bees/syrphids for file name#
                        occ, ## occ data? TRUE/FALSE#
                        fig.path = 'figures/betadisper',#
                        add.labels=TRUE){  #
  ## cols <-brewer.pal(6, 'Dark2')[c(6,2,1)]#
  cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
  f <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    means <- c(coef(mod)[1,1],#
               coef(mod)[1,1] + coef(mod)[3,1],#
               coef(mod)[1,1] + coef(mod)[2,1])#
    ci.ub <- means +#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    ci.lb <- means -#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    plot(x=1:3, y=means,#
         col=cols,#
         pch=16,#
         ylim=c(0,0.6),#
         xlim=c(0.5,3.5),#
         xlab='',#
         xaxt='n',#
         cex=1.5, las=1)#
    arrows(x0=1:3,#
           y0= ci.lb, y1=ci.ub, angle=90,#
           length=0, code=3, col=cols, lwd=1.5)#
    mtext("Species temporal turnover", 2, line=3.5 , cex=2)#
    if(add.labels){#
      axis(1, at= 1:3,#
           labels=c("Non-assembling \n field margin",#
             "Assembling \n  hedgerow",#
             "Non-assembling \n hedgerow"))#
    }#
  }#
  pdf.f(f, file= file.path(fig.path, sprintf('%s.pdf',#
             paste('coeff', type,#
                   occ,#
                   dis.method,#
                   sub,#
                   sep='_'))),#
        width=6, height=6)#
}#
plot.node.box <- function(ylabel,#
                          dats,#
                          y1){#
  makeNodeBox <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext(ylabel, 2, line=3.5, cex=1.5)#
  }#
  path <- 'figures'#
  pdf.f(makeNodeBox, file=file.path(path,#
                       sprintf("%s.pdf", paste(#
                         gsub(" ", "", ylabel),#
                         "box", sep="_"))),#
        width=6, height=6)#
}#
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(5, 3, 3, 1),#
        mar=c(3, 4, 0, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinator species turnover",#
          3, line=2, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plant species turnover",#
          3, line=2, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interaction turnover",#
          3, line=2, cex=1.2)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 3, at = 1:3, cex=1.1)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interaction turnover", 2, line=4, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=5, height=5)#
}
plotDistPanels()
library(RColorBrewer)#
library(beeswarm)#
## box plot#
#
plot.beta.div <- function(dis.method, ## dissmiliarity method for file name#
                          dists, ## beta-div estimate (box data)#
                          status, ## vector of site statuses (box catagoties)#
                          type, ## time or space for ylab#
                          sub, ## bees/syrphids for file name#
                          occ,## occ data? TRUE/FALSE#
                          fig.path = 'figures/betadisper',#
                          ylabel){#
  makeBetaBox <- function(){#
#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1,#
            ylim=c(0,1))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
#
    mtext(ylabel,#
          2, line=3.5, cex=1.5)#
#
  }#
  pdf.f(makeBetaBox,#
        file= file.path(fig.path, sprintf('%s.pdf',#
          paste(type,#
                occ,#
                dis.method,#
                sub,#
                sep='_'))),#
        width=6, height=6)#
}#
#
## extracts model coefficients and SE and plots them as points and#
## lines#
#
plot.coeffs <- function(dis.method, ## dissmiliarity method for file name#
                        mod, ## model object#
                        status, ## vector of site statuses #
                        type,  ## time or space for ylab#
                        sub, ## bees/syrphids for file name#
                        occ, ## occ data? TRUE/FALSE#
                        fig.path = 'figures/betadisper',#
                        add.labels=TRUE){  #
  ## cols <-brewer.pal(6, 'Dark2')[c(6,2,1)]#
  cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
  f <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    means <- c(coef(mod)[1,1],#
               coef(mod)[1,1] + coef(mod)[3,1],#
               coef(mod)[1,1] + coef(mod)[2,1])#
    ci.ub <- means +#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    ci.lb <- means -#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    plot(x=1:3, y=means,#
         col=cols,#
         pch=16,#
         ylim=c(0,0.6),#
         xlim=c(0.5,3.5),#
         xlab='',#
         xaxt='n',#
         cex=1.5, las=1)#
    arrows(x0=1:3,#
           y0= ci.lb, y1=ci.ub, angle=90,#
           length=0, code=3, col=cols, lwd=1.5)#
    mtext("Species temporal turnover", 2, line=3.5 , cex=2)#
    if(add.labels){#
      axis(1, at= 1:3,#
           labels=c("Non-assembling \n field margin",#
             "Assembling \n  hedgerow",#
             "Non-assembling \n hedgerow"))#
    }#
  }#
  pdf.f(f, file= file.path(fig.path, sprintf('%s.pdf',#
             paste('coeff', type,#
                   occ,#
                   dis.method,#
                   sub,#
                   sep='_'))),#
        width=6, height=6)#
}#
plot.node.box <- function(ylabel,#
                          dats,#
                          y1){#
  makeNodeBox <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext(ylabel, 2, line=3.5, cex=1.5)#
  }#
  path <- 'figures'#
  pdf.f(makeNodeBox, file=file.path(path,#
                       sprintf("%s.pdf", paste(#
                         gsub(" ", "", ylabel),#
                         "box", sep="_"))),#
        width=6, height=6)#
}#
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(5, 3, 3, 1),#
        mar=c(3, 4, 0, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=2, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=2, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=2, cex=1.2)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1, ylim=c(0,1))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 3, at = 1:3, cex=1.1)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=4, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=5, height=5)#
}
plotDistPanels()
library(RColorBrewer)#
library(beeswarm)#
## box plot#
#
plot.beta.div <- function(dis.method, ## dissmiliarity method for file name#
                          dists, ## beta-div estimate (box data)#
                          status, ## vector of site statuses (box catagoties)#
                          type, ## time or space for ylab#
                          sub, ## bees/syrphids for file name#
                          occ,## occ data? TRUE/FALSE#
                          fig.path = 'figures/betadisper',#
                          ylabel){#
  makeBetaBox <- function(){#
#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1,#
            ylim=c(0,1))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
#
    mtext(ylabel,#
          2, line=3.5, cex=1.5)#
#
  }#
  pdf.f(makeBetaBox,#
        file= file.path(fig.path, sprintf('%s.pdf',#
          paste(type,#
                occ,#
                dis.method,#
                sub,#
                sep='_'))),#
        width=6, height=6)#
}#
#
## extracts model coefficients and SE and plots them as points and#
## lines#
#
plot.coeffs <- function(dis.method, ## dissmiliarity method for file name#
                        mod, ## model object#
                        status, ## vector of site statuses #
                        type,  ## time or space for ylab#
                        sub, ## bees/syrphids for file name#
                        occ, ## occ data? TRUE/FALSE#
                        fig.path = 'figures/betadisper',#
                        add.labels=TRUE){  #
  ## cols <-brewer.pal(6, 'Dark2')[c(6,2,1)]#
  cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
  f <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    means <- c(coef(mod)[1,1],#
               coef(mod)[1,1] + coef(mod)[3,1],#
               coef(mod)[1,1] + coef(mod)[2,1])#
    ci.ub <- means +#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    ci.lb <- means -#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    plot(x=1:3, y=means,#
         col=cols,#
         pch=16,#
         ylim=c(0,0.6),#
         xlim=c(0.5,3.5),#
         xlab='',#
         xaxt='n',#
         cex=1.5, las=1)#
    arrows(x0=1:3,#
           y0= ci.lb, y1=ci.ub, angle=90,#
           length=0, code=3, col=cols, lwd=1.5)#
    mtext("Species temporal turnover", 2, line=3.5 , cex=2)#
    if(add.labels){#
      axis(1, at= 1:3,#
           labels=c("Non-assembling \n field margin",#
             "Assembling \n  hedgerow",#
             "Non-assembling \n hedgerow"))#
    }#
  }#
  pdf.f(f, file= file.path(fig.path, sprintf('%s.pdf',#
             paste('coeff', type,#
                   occ,#
                   dis.method,#
                   sub,#
                   sep='_'))),#
        width=6, height=6)#
}#
plot.node.box <- function(ylabel,#
                          dats,#
                          y1){#
  makeNodeBox <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext(ylabel, 2, line=3.5, cex=1.5)#
  }#
  path <- 'figures'#
  pdf.f(makeNodeBox, file=file.path(path,#
                       sprintf("%s.pdf", paste(#
                         gsub(" ", "", ylabel),#
                         "box", sep="_"))),#
        width=6, height=6)#
}#
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2, 3, 3, 1),#
        mar=c(1, 4, 0, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=2, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=2, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=2, cex=1.2)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1, ylim=c(0,1))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 3, at = 1:3, cex=1.1)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=4, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=5, height=5)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2, 3, 3, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=2, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=1, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=1, cex=1.2)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 3, at = 1:3, cex=1.1)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=1, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=5, height=5)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2, 3, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=1, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=1, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=1, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 3, at = 1:3, cex=0.9)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 3, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=1, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=5, height=5)#
}
plotDistPanels()
library(RColorBrewer)#
library(beeswarm)#
## box plot#
#
plot.beta.div <- function(dis.method, ## dissmiliarity method for file name#
                          dists, ## beta-div estimate (box data)#
                          status, ## vector of site statuses (box catagoties)#
                          type, ## time or space for ylab#
                          sub, ## bees/syrphids for file name#
                          occ,## occ data? TRUE/FALSE#
                          fig.path = 'figures/betadisper',#
                          ylabel){#
  makeBetaBox <- function(){#
#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',#
            names=c("","",""),#
            las=1,#
            ylim=c(0,1))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
#
    mtext(ylabel,#
          2, line=3.5, cex=1.5)#
#
  }#
  pdf.f(makeBetaBox,#
        file= file.path(fig.path, sprintf('%s.pdf',#
          paste(type,#
                occ,#
                dis.method,#
                sub,#
                sep='_'))),#
        width=6, height=6)#
}#
#
## extracts model coefficients and SE and plots them as points and#
## lines#
#
plot.coeffs <- function(dis.method, ## dissmiliarity method for file name#
                        mod, ## model object#
                        status, ## vector of site statuses #
                        type,  ## time or space for ylab#
                        sub, ## bees/syrphids for file name#
                        occ, ## occ data? TRUE/FALSE#
                        fig.path = 'figures/betadisper',#
                        add.labels=TRUE){  #
  ## cols <-brewer.pal(6, 'Dark2')[c(6,2,1)]#
  cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
  f <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    means <- c(coef(mod)[1,1],#
               coef(mod)[1,1] + coef(mod)[3,1],#
               coef(mod)[1,1] + coef(mod)[2,1])#
    ci.ub <- means +#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    ci.lb <- means -#
      c(coef(mod)[1,2], coef(mod)[3,2], coef(mod)[2,2])#
    plot(x=1:3, y=means,#
         col=cols,#
         pch=16,#
         ylim=c(0,0.6),#
         xlim=c(0.5,3.5),#
         xlab='',#
         xaxt='n',#
         cex=1.5, las=1)#
    arrows(x0=1:3,#
           y0= ci.lb, y1=ci.ub, angle=90,#
           length=0, code=3, col=cols, lwd=1.5)#
    mtext("Species temporal turnover", 2, line=3.5 , cex=2)#
    if(add.labels){#
      axis(1, at= 1:3,#
           labels=c("Non-assembling \n field margin",#
             "Assembling \n  hedgerow",#
             "Non-assembling \n hedgerow"))#
    }#
  }#
  pdf.f(f, file= file.path(fig.path, sprintf('%s.pdf',#
             paste('coeff', type,#
                   occ,#
                   dis.method,#
                   sub,#
                   sep='_'))),#
        width=6, height=6)#
}#
plot.node.box <- function(ylabel,#
                          dats,#
                          y1){#
  makeNodeBox <- function(){#
    par(oma=c(2,6,1,1), mar=c(5,0,2,0.5), mgp=c(2,1,0),#
        cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""))#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext(ylabel, 2, line=3.5, cex=1.5)#
  }#
  path <- 'figures'#
  pdf.f(makeNodeBox, file=file.path(path,#
                       sprintf("%s.pdf", paste(#
                         gsub(" ", "", ylabel),#
                         "box", sep="_"))),#
        width=6, height=6)#
}#
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2, 3, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=5, height=5)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2, 3, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=6, height=6)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2, 3, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=7, height=7)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2, 4, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    mtext("Turnover", 2, line=3, adj=-1)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=8, height=8)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2, 5, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    mtext("Turnover", 2, line=3, adj=-1)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=9, height=9)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2.5, 6, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    mtext("Turnover", 2, line=3)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=9, height=9)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2.5, 6, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    mtext("Turnover", 2, line=3.5, cex=1.2)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=9, height=9)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2.5, 6, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    mtext("Turnover", 2, line=3.5, cex=1.2, adj=0)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=9, height=9)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2.5, 6, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    mtext("Turnover", 2, line=3.5, cex=1.2, adj=1)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=9, height=9)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2.5, 6, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    mtext("Turnover", 2, line=4, cex=1.2, adj=2)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=9, height=9)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2.5, 6, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    mtext("Turnover", 2, line=4, cex=1.2, adj=1.75)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=9, height=9)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2.5, 6, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    mtext("Turnover", 2, line=4, cex=1.2, adj=1.5)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=10, height=9)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2.5, 6, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    mtext("Turnover", 2, line=4, cex=1.2, adj=1.4)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=10, height=9)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2.5, 6, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.2)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.2)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.2)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    mtext("Turnover", 2, line=4, cex=1.2, adj=1.2)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.2)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=10, height=9)#
}
plotDistPanels()
plotDistPanels <- function(){#
  f3 <- function(){#
    layout(matrix(1:4, ncol=2, byrow=TRUE))#
    par(oma=c(2.5, 6, 1, 1),#
        mar=c(1, 1, 2, 1), cex.axis=1.5)#
    cols <- brewer.pal(4, "Greys")[c(2,3,4)]#
    cols.fills <- add.alpha(cols, alpha=0.5)#
#
    ## pollinator species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="pols", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='', ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Pollinators",#
          3, line=0.9, cex=1.3)#
#
    ## plant species turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="plants", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1, xaxt="n", yaxt="n")#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Plants",#
          3, line=0.9, cex=1.3)#
    ## interaction turnover#
    load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
           paste(dis.method, alpha, occ, type="int", sep='_'))))#
    dists <- dats.pols$dist#
    status <- dats.pols$status#
    status <- factor(status,#
                     levels=c('control', 'maturing',#
                       'mature'))#
    boxplot(dists ~ status, col=cols.fills,#
            xlab='', ylab='',ylim=c(0,1),#
            names=c("","",""),#
            las=1)#
    beeswarm(dists ~ status, col = cols, add = TRUE)#
    mtext("Interactions",#
          3, line=0.9, cex=1.3)#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    mtext("Turnover", 2, line=4, cex=1.3, adj=1.2)#
    ## weighted link turnover#
    load(file="saved/phyloInt.Rdata")#
    dats <- phylo.int$phylo.int#
    y1 <- "PhyloInt"#
    boxplot(dats[,y1]~ dats$SiteStatus,#
            col=cols.fills,#
            names=c("","",""), las=1,#
            ylim=c(0,1), yaxt="n")#
    mtext(c("Non-assembling \n field margin",#
            "Assembling \n  hedgerow",#
            "Non-assembling \n hedgerow"),#
          side = 1, line= 2, at = 1:3, cex=0.9)#
    beeswarm(dats[,y1]~ dats$SiteStatus, col = cols, add = TRUE)#
    mtext("Weighted interactions", 3, line=0.9, cex=1.3)#
  }#
  path <- 'figures'#
  pdf.f(f3, file=file.path(path,#
              sprintf("%s.pdf", "turnover_panels")),#
        width=10, height=9)#
}
plotDistPanels()
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/variability')#
binary <- FALSE#
alpha <- TRUE#
## int or pols#
type <- "pols"#
source('src/initialize_beta.R')#
#
## ************************************************************#
## beta diversity as variation between years,#
## centroid for each site#
## ************************************************************#
dis <- mapply(function(a, b, c, d)#
              beta.status(comm= a,#
                          status= b,#
                          dis.method,#
                          nulls=c,#
                          occ=binary,#
                          years=d,#
                          sub=type),#
              a=comm$comm,#
              b=comm$status,#
              c= nulls,#
              d= comm$comm,#
              SIMPLIFY=FALSE)#
#
dats <- data.frame(site=comm$sites,#
                   status=unlist(comm$status),#
                   year=unlist(comm$years),#
                   dist=unlist(sapply(dis, function(x)#
                     x$distances)))#
rownames(dats) <- NULL#
#
save(dats, file= file.path('saved/speciesTurnover',#
             sprintf('%s.pdf', paste(dis.method, alpha, occ, type,#
                                     sep='_'))))#
#
## invid nulls all not sig, alpha nulls mature marginally sig less,#
## occurrence nulls all not sig#
#
## run model, plot#
#
load(file= file.path('saved/speciesTurnover', sprintf('%s.pdf',#
       paste(dis.method, alpha, occ, type, sep='_'))))#
mod <- lmer(dist ~ status +  (1|site),#
            data=dats)#
summary(mod)#
#
plot.beta.div(dis.method =dis.method, dists= dats$dist,#
              status= dats$status, type= "time",#
              sub= type, occ=occ, ylabel=ylabel)#
#
plot.coeffs(dis.method =dis.method, mod=summary(mod),#
            status= dats$status, type= "space",#
            sub= type, occ=occ)#
plotDistPanels()
?boxplot
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/changePoint')#
source('plotting/src/initialize.R')#
#
sites <- sapply(strsplit(names(graphs), "_"), function(x) x[1])#
sites.trees <- sapply(strsplit(temp, "_"), function(x) x[1])#
all.poss.yrs <- 2006:2015#
#
for(i in unique(sites.trees)){#
  print(i)#
  net <- nets[sites == i]#
  yrs <- sapply(strsplit(names(net), "[.]"), function(x) x[2])#
  names(net) <- yrs#
  arr <- simplify2array(net)#
  all.years <-  apply(arr, c(1,2), sum)#
  plant.sums <- rowSums(all.years)#
  pol.sums <- colSums(all.years)#
  this.tree <- tree.graphs[sites.trees == i]#
  pdf.f(plotNet,#
        file=file.path(fig.path, sprintf("%s_networks.pdf", i)),#
        width=18, height=4)#
  pdf.f(plotDend,#
        file=file.path(fig.path, sprintf("%s_dend.pdf", i)),#
        width=10, height=4)#
}
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/changePoint')#
source('plotting/src/initialize.R')#
#
sites <- sapply(strsplit(names(graphs), "_"), function(x) x[1])#
sites.trees <- sapply(strsplit(temp, "_"), function(x) x[1])#
all.poss.yrs <- 2006:2015#
#
for(i in unique(sites.trees)){#
  print(i)#
  net <- nets[sites == i]#
  yrs <- sapply(strsplit(names(net), "[.]"), function(x) x[2])#
  names(net) <- yrs#
  arr <- simplify2array(net)#
  all.years <-  apply(arr, c(1,2), sum)#
  plant.sums <- rowSums(all.years)#
  pol.sums <- colSums(all.years)#
  this.tree <- tree.graphs[sites.trees == i]#
  pdf.f(plotNet,#
        file=file.path(fig.path, sprintf("%s_networks.pdf", i)),#
        width=18, height=4)#
  pdf.f(plotDend,#
        file=file.path(fig.path, sprintf("%s_dend.pdf", i)),#
        width=10, height=4)#
}
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/changePoint')#
source('plotting/src/initialize.R')#
#
sites <- sapply(strsplit(names(graphs), "_"), function(x) x[1])#
sites.trees <- sapply(strsplit(temp, "_"), function(x) x[1])#
all.poss.yrs <- 2006:2015#
#
for(i in unique(sites.trees)){#
  print(i)#
  net <- nets[sites == i]#
  yrs <- sapply(strsplit(names(net), "[.]"), function(x) x[2])#
  names(net) <- yrs#
  arr <- simplify2array(net)#
  all.years <-  apply(arr, c(1,2), sum)#
  plant.sums <- rowSums(all.years)#
  pol.sums <- colSums(all.years)#
  this.tree <- tree.graphs[sites.trees == i]#
  pdf.f(plotNet,#
        file=file.path(fig.path, sprintf("%s_networks.pdf", i)),#
        width=18, height=4)#
  pdf.f(plotDend,#
        file=file.path(fig.path, sprintf("%s_dend.pdf", i)),#
        width=10, height=4)#
}
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/changePoint')#
source('plotting/src/initialize.R')#
#
sites <- sapply(strsplit(names(graphs), "_"), function(x) x[1])#
sites.trees <- sapply(strsplit(temp, "_"), function(x) x[1])#
all.poss.yrs <- 2006:2015#
#
for(i in unique(sites.trees)){#
  print(i)#
  net <- nets[sites == i]#
  yrs <- sapply(strsplit(names(net), "[.]"), function(x) x[2])#
  names(net) <- yrs#
  arr <- simplify2array(net)#
  all.years <-  apply(arr, c(1,2), sum)#
  plant.sums <- rowSums(all.years)#
  pol.sums <- colSums(all.years)#
  this.tree <- tree.graphs[sites.trees == i]#
  pdf.f(plotNet,#
        file=file.path(fig.path, sprintf("%s_networks.pdf", i)),#
        width=18, height=4)#
  pdf.f(plotDend,#
        file=file.path(fig.path, sprintf("%s_dend.pdf", i)),#
        width=10, height=4)#
}
?plotDend
?dendPlot
?dendPlot
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/changePoint')#
source('plotting/src/initialize.R')#
#
sites <- sapply(strsplit(names(graphs), "_"), function(x) x[1])#
sites.trees <- sapply(strsplit(temp, "_"), function(x) x[1])#
all.poss.yrs <- 2006:2015#
#
for(i in unique(sites.trees)){#
  print(i)#
  net <- nets[sites == i]#
  yrs <- sapply(strsplit(names(net), "[.]"), function(x) x[2])#
  names(net) <- yrs#
  arr <- simplify2array(net)#
  all.years <-  apply(arr, c(1,2), sum)#
  plant.sums <- rowSums(all.years)#
  pol.sums <- colSums(all.years)#
  this.tree <- tree.graphs[sites.trees == i]#
  pdf.f(plotNet,#
        file=file.path(fig.path, sprintf("%s_networks.pdf", i)),#
        width=18, height=4)#
  pdf.f(plotDend,#
        file=file.path(fig.path, sprintf("%s_dend.pdf", i)),#
        width=10, height=4)#
}
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/changePoint')#
source('plotting/src/initialize.R')#
#
sites <- sapply(strsplit(names(graphs), "_"), function(x) x[1])#
sites.trees <- sapply(strsplit(temp, "_"), function(x) x[1])#
all.poss.yrs <- 2006:2015#
#
for(i in unique(sites.trees)){#
  print(i)#
  net <- nets[sites == i]#
  yrs <- sapply(strsplit(names(net), "[.]"), function(x) x[2])#
  names(net) <- yrs#
  arr <- simplify2array(net)#
  all.years <-  apply(arr, c(1,2), sum)#
  plant.sums <- rowSums(all.years)#
  pol.sums <- colSums(all.years)#
  this.tree <- tree.graphs[sites.trees == i]#
  pdf.f(plotNet,#
        file=file.path(fig.path, sprintf("%s_networks.pdf", i)),#
        width=18, height=4)#
  pdf.f(plotDend,#
        file=file.path(fig.path, sprintf("%s_dend.pdf", i)),#
        width=10, height=4)#
}
rm(list=ls())#
setwd('~/Dropbox/hedgerow_assembly/analysis/changePoint')#
source('plotting/src/initialize.R')#
#
sites <- sapply(strsplit(names(graphs), "_"), function(x) x[1])#
sites.trees <- sapply(strsplit(temp, "_"), function(x) x[1])#
all.poss.yrs <- 2006:2015#
#
for(i in unique(sites.trees)){#
  print(i)#
  net <- nets[sites == i]#
  yrs <- sapply(strsplit(names(net), "[.]"), function(x) x[2])#
  names(net) <- yrs#
  arr <- simplify2array(net)#
  all.years <-  apply(arr, c(1,2), sum)#
  plant.sums <- rowSums(all.years)#
  pol.sums <- colSums(all.years)#
  this.tree <- tree.graphs[sites.trees == i]#
  pdf.f(plotNet,#
        file=file.path(fig.path, sprintf("%s_networks.pdf", i)),#
        width=18, height=4)#
  pdf.f(plotDend,#
        file=file.path(fig.path, sprintf("%s_dend.pdf", i)),#
        width=10, height=4)#
}
